/*! @logue/reverb v0.1.0 | Logue | license: MIT */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Reverb",[],t):"object"==typeof exports?exports.Reverb=t():e.Reverb=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"default",function(){return r});
/**
 * JS reverb effect class
 *
 * @author    Logue
 * @copyright 2019 Logue <logue@hotmail.co.jp>
 * @license   MIT
 * @see       {@link https://github.com/logue/Reverb.js}
 *            {@link https://github.com/web-audio-components/simple-reverb}
 */
var r=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.wetGainNode=this.ctx.createGain(),this.dryGainNode=this.ctx.createGain(),this.feedbackGainNode=this.ctx.createGain(),this.delayNode=this.ctx.createDelay(),this.convolverNode=this.ctx.createConvolver(),this.filterNode=this.ctx.createBiquadFilter(),this._freq=i.freq||440,this._decay=i.decay||1,this._delay=i.delay||.5,this._filterType=i.filterType||"bandpass",this._mix=i.mix||.5,this._reverse=i.reverse||!1,this._time=i.time||1,this.filterType(this._filterType),this.mix(this._mix),this.freq(this._freq),this.convolverNode.connect(this.filterNode).connect(this.wetGainNode).connect(this.ctx.destination),this.dryGainNode.connect(this.ctx.destination)}var t,i,r;return t=e,(i=[{key:"connect",value:function(e){e.connect(this.dryGainNode),e.connect(this.convolverNode)}},{key:"disconnect",value:function(e){e.disconnect(this.dryGainNode),e.disconnect(this.convolverNode)}},{key:"mix",value:function(e){this._mix=e,this.dryGainNode.gain.setTargetAtTime(this.getDryLevel(e)/127,this.ctx.currentTime,.015),this.wetGainNode.gain.setTargetAtTime(this.getWetLevel(e)/127,this.ctx.currentTime,.015)}},{key:"time",value:function(e){this._time=e,this.buildImpulse()}},{key:"decay",value:function(e){this._decay=e,this.buildImpulse()}},{key:"delay",value:function(e){this._delay=e,this.buildImpulse()}},{key:"reverse",value:function(e){this._reverse=e,this.buildImpulse()}},{key:"freq",value:function(e){this._freq=e,this.filterNode.frequency.setTargetAtTime(this._freq,this.ctx.currentTime,.015)}},{key:"filterType",value:function(e){this.filterNode.type=this._filterType=e}},{key:"buildImpulse",value:function(){for(var e=this.ctx.sampleRate,t=Math.max(e*this._time,1),i=e*this._delay,n=this.ctx.createBuffer(2,t,e),r=new Float32Array(t),o=new Float32Array(t),s=0;s<t;s++){var a=Math.pow(1-c/t,this._decay),c=0;s<i?(r[s]=0,o[s]=0,c=this._reverse?t-(s-i):s-i):c=this._reverse?t-s:s,r[s]=(2*Math.random()-1)*a,o[s]=(2*Math.random()-1)*a}n.getChannelData(0).set(r),n.getChannelData(1).set(o),this.node.buffer=n}},{key:"getDryLevel",value:function(e){return e>1||e<0?0:e<=.5?1:1-2*(e-.5)}},{key:"getWetLevel",value:function(e){return e>1||e<0?0:e>=.5?1:1-2*(e-.5)}}])&&n(t.prototype,i),r&&n(t,r),e}()}])});